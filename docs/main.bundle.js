(()=>{"use strict";const e={"node-tiles":{type:"vector",url:"https://tiles.dvrpc.org/data/lts-nodes.json",minzoom:8},"route-src":{type:"geojson",data:{type:"FeatureCollection",features:[{id:"0",type:"Feature",properties:{id:349428,seq:1},geometry:{type:"MultiLineString",coordinates:[[[-74.91728499979,39.795013999595604],[-74.91628399994785,39.795174999945274]]]}}]}}};mapboxgl.accessToken="pk.eyJ1IjoiYWFyb25kdnJwYyIsImEiOiJja2NvN2s5dnAwaWR2MnptbzFwYmd2czVvIn0.Fcc34gzGME_zHR5q4RnSOg";const t={nodes:{id:"nodes",type:"circle",source:"node-tiles","source-layer":"lts_nodes",layout:{},paint:{"circle-opacity":.7,"circle-color":"pink","circle-radius":3},minzoom:9.5},start:{id:"start",type:"circle",source:"node-tiles","source-layer":"lts_nodes",layout:{},paint:{"circle-opacity":.7,"circle-color":"green","circle-radius":10},filter:["==","nodeid","-1"]},end:{id:"end",type:"circle",source:"node-tiles","source-layer":"lts_nodes",layout:{},paint:{"circle-opacity":.7,"circle-color":"red","circle-radius":10},filter:["==","nodeid","-1"]},route:{id:"route",type:"line",source:"route-src",layout:{},paint:{"line-opacity":.7,"line-color":"green","line-width":6}}},o=document.getElementById("button-to-select-start"),n=document.getElementById("button-to-select-end"),i=document.getElementById("button-to-find-route"),s=e=>e.classList.contains("selected-button"),r=e=>{s(e)&&e.classList.remove("selected-button")},a=e=>{["nodes"].forEach((t=>((e,t)=>{e.on("mouseenter",t,(function(t){(s(o)||s(n))&&(e.getCanvas().style.cursor="pointer")})),e.on("mouseleave",t,(function(t){e.getCanvas().style.cursor=""}))})(e,t)))};var l=function(){return l=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},l.apply(this,arguments)},d={lines:12,length:7,width:5,radius:10,scale:1,corners:1,color:"#000",fadeColor:"transparent",animation:"spinner-line-fade-default",rotate:0,direction:1,speed:1,zIndex:2e9,className:"spinner",top:"50%",left:"50%",shadow:"0 0 1px transparent",position:"absolute"},c=function(){function e(e){void 0===e&&(e={}),this.opts=l(l({},d),e)}return e.prototype.spin=function(e){return this.stop(),this.el=document.createElement("div"),this.el.className=this.opts.className,this.el.setAttribute("role","progressbar"),p(this.el,{position:this.opts.position,width:0,zIndex:this.opts.zIndex,left:this.opts.left,top:this.opts.top,transform:"scale("+this.opts.scale+")"}),e&&e.insertBefore(this.el,e.firstChild||null),function(e,t){var o=Math.round(t.corners*t.width*500)/1e3+"px",n="none";!0===t.shadow?n="0 2px 4px #000":"string"==typeof t.shadow&&(n=t.shadow);for(var i=function(e){for(var t=/^\s*([a-zA-Z]+\s+)?(-?\d+(\.\d+)?)([a-zA-Z]*)\s+(-?\d+(\.\d+)?)([a-zA-Z]*)(.*)$/,o=[],n=0,i=e.split(",");n<i.length;n++){var s=i[n].match(t);if(null!==s){var r=+s[2],a=+s[5],l=s[4],d=s[7];0!==r||l||(l=d),0!==a||d||(d=l),l===d&&o.push({prefix:s[1]||"",x:r,y:a,xUnits:l,yUnits:d,end:s[8]})}}return o}(n),s=0;s<t.lines;s++){var r=~~(360/t.lines*s+t.rotate),a=p(document.createElement("div"),{position:"absolute",top:-t.width/2+"px",width:t.length+t.width+"px",height:t.width+"px",background:u(t.fadeColor,s),borderRadius:o,transformOrigin:"left",transform:"rotate("+r+"deg) translateX("+t.radius+"px)"}),l=s*t.direction/t.lines/t.speed;l-=1/t.speed;var d=p(document.createElement("div"),{width:"100%",height:"100%",background:u(t.color,s),borderRadius:o,boxShadow:h(i,r),animation:1/t.speed+"s linear "+l+"s infinite "+t.animation});a.appendChild(d),e.appendChild(a)}}(this.el,this.opts),this},e.prototype.stop=function(){return this.el&&("undefined"!=typeof requestAnimationFrame?cancelAnimationFrame(this.animateId):clearTimeout(this.animateId),this.el.parentNode&&this.el.parentNode.removeChild(this.el),this.el=void 0),this},e}();function p(e,t){for(var o in t)e.style[o]=t[o];return e}function u(e,t){return"string"==typeof e?e:e[t%e.length]}function h(e,t){for(var o=[],n=0,i=e;n<i.length;n++){var s=i[n],r=f(s.x,s.y,t);o.push(s.prefix+r[0]+s.xUnits+" "+r[1]+s.yUnits+s.end)}return o.join(", ")}function f(e,t,o){var n=o*Math.PI/180,i=Math.sin(n),s=Math.cos(n);return[Math.round(1e3*(e*s+t*i))/1e3,Math.round(1e3*(-e*i+t*s))/1e3]}let m=0,y=0;const g=e=>{o.onclick=()=>{s(o)?r(o):(o.classList.add("selected-button"),r(n))},n.onclick=()=>{s(n)?r(n):(n.classList.add("selected-button"),r(o))},i.onclick=()=>{r(o),r(n);var t=document.getElementById("spinner"),i=new c({lines:13,length:38,width:17,radius:45,scale:1,corners:1,speed:1,rotate:0,animation:"spinner-line-fade-quick",direction:1,color:"black",fadeColor:"transparent",top:"50%",left:"50%",shadow:"0 0 1px transparent",zIndex:2e9,className:"spinner",position:"absolute"}).spin(t);let s="https://low-stress-bike-routing-ocy3k.ondigitalocean.app/api/lowstress/route/?start="+m.toString()+"&end="+y.toString();var a=new XMLHttpRequest;a.open("GET",s,!0),a.setRequestHeader("Access-Control-Allow-Origin","*"),a.onload=function(){if(this.status>=200&&this.status<400){var t=JSON.parse(this.response);e.getSource("route-src").setData(t),console.log("Updated"),i.stop()}},a.send()}},v={all_pois:{id:"nodes",attribute:"circle-radius",style:["interpolate",["linear"],["zoom"],9.5,1,18,6]}},b=new mapboxgl.Map({container:"map",style:"mapbox://styles/dvrpcomad/cks6eiqga0tmc17p3ecw7ij53",center:[-75.16362,39.95238],zoom:9.5});b.on("load",(function(){for(const t in e)b.addSource(t,e[t]);for(const e in t)b.addLayer(t[e]);a(b),(e=>{g(e),e.on("click","nodes",(function(t){let i=t.features[0].properties;console.log(i);let r="";s(o)?(r="start",m=i.nodeid):s(n)&&(r="end",y=i.nodeid),e.setFilter(r,["==","nodeid",i.nodeid])}))})(b);for(const e in v)b.setPaintProperty(v[e].id,v[e].attribute,v[e].style)}))})();